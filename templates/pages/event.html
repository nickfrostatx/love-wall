{% extends "lib/base.html" %}

{% macro heart() -%}
      <svg viewbox="0 0 497 470">
        <g stroke="#ffb6c1" stroke-width="20">
          <path d="M140,20C73,20 20,74 20,140 20,275 156,310 248,443 336,311 477,270 477,140 477,74 423,20 357,20 309,20 267,48 248,89 229,48 188,20 140,20Z"/>
        </g>
      </svg>
{%- endmacro %}

{% block body %}
    <h1>{{ event.location_name }}</h1>
    {%- if hearted %}
    <span class="heart voted">{{ heart() }}</span>
    {%- else %}
    <a class="heart" id="heart" href="{{ url_for('app.heart', id=event.id, token=session['csrf']) }}">{{ heart() }}</a>
    {%- endif %}
    <span id="score">{{ event.get_score() }}</span>
    <script>
      var heart = document.getElementById('heart');
      if (heart !== null) {
        var scoreElem = document.getElementById('score');
        document.getElementById('heart').addEventListener('click', function(e) {
          e.preventDefault();
          var xhr = new XMLHttpRequest();
          xhr.open('GET', this.getAttribute('href'));
          xhr.send();
          this.className = 'heart voted';
          scoreElem.textContent = parseInt(scoreElem.textContent) + 1;
        });
      }
    </script>
{%- endblock %}
